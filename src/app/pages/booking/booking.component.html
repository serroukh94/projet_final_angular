<div class="booking-page">
  <a routerLink="/" class="back-link">← Retour à l'accueil</a>
  <h1>Réserver une voiture</h1>
  <p class="subtitle">Remplissez les informations ci-dessous pour votre réservation.</p>

  <form [formGroup]="bookingForm" (ngSubmit)="submitForm()" class="booking-form">
    <div class="form-group">
      <label for="fullName">Nom complet</label>
      <input
        id="fullName"
        type="text"
        placeholder="Ex: Jean Dupont"
        formControlName="fullName"
      />
      <small class="error" *ngIf="bookingForm.get('fullName')?.invalid && bookingForm.get('fullName')?.touched">
        Le nom complet est requis (minimum 3 caractères).
      </small>
    </div>

    <div class="form-group">
      <label for="email">Adresse email</label>
      <input
        id="email"
        type="email"
        placeholder="Ex: jean.dupont@gmail.com"
        formControlName="email"
      />
      <small class="error" *ngIf="bookingForm.get('email')?.invalid && bookingForm.get('email')?.touched">
        Veuillez entrer une adresse email valide.
      </small>
    </div>

    <div class="form-group">
      <label for="carModel">Modèle de voiture</label>
      <select
        id="carModel"
        formControlName="carModel"
        (change)="onCarModelChange()"
      >
        <option value="">-- Sélectionnez une voiture --</option>
        <option *ngFor="let car of allCars" [value]="car.name">{{ car.name }} - {{ car.pricePerDay }}€/jour</option>
      </select>
      <small class="error" *ngIf="bookingForm.get('carModel')?.invalid && bookingForm.get('carModel')?.touched">
        Veuillez sélectionner une voiture.
      </small>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="startDate">Date de début</label>
        <input
          id="startDate"
          type="date"
          formControlName="startDate"
        />
        <small class="error" *ngIf="bookingForm.get('startDate')?.invalid && bookingForm.get('startDate')?.touched">
          La date de début est requise.
        </small>
      </div>

      <div class="form-group">
        <label for="endDate">Date de fin</label>
        <input
          id="endDate"
          type="date"
          formControlName="endDate"
          [min]="bookingForm.get('startDate')?.value"
        />
        <small class="error" *ngIf="bookingForm.get('endDate')?.invalid && bookingForm.get('endDate')?.touched">
          La date de fin est requise.
        </small>
      </div>
    </div>

    <div *ngIf="numberOfDays > 0 && selectedCar" class="price-summary">
      <p><strong>Durée :</strong> {{ numberOfDays }} jour(s)</p>
      <p><strong>Prix par jour :</strong> {{ selectedCar.pricePerDay }} €</p>
      <p class="total"><strong>Prix total :</strong> {{ totalPrice }} €</p>
    </div>

    <div class="form-group">
      <label for="message">Remarques (optionnel)</label>
      <textarea
        id="message"
        rows="3"
        placeholder="Ex: Besoin d'un siège bébé, livraison à domicile, etc."
        formControlName="message"
      ></textarea>
    </div>

    <button type="submit" class="btn-submit">Confirmer la réservation</button>
  </form>

  <p *ngIf="successMessage" class="success">{{ successMessage }}</p>
</div>
